<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>ActiveTcl 8.6.9 Documentation</title>
    <meta name="generator" content="Hugo 0.26" />

    
    <meta name="description" content="Complete documentation for ActiveTcl 8.6.9">
    
    <link rel="canonical" href="tsv.html">
    

    
    <meta name="apple-mobile-web-app-title" content="ActiveTcl 8.6.9 Documentation">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="../../../images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="../../../images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('../../../fonts/icon.eot');
        src: url('../../../fonts/icon.eot')
               format('embedded-opentype'),
             url('../../../fonts/icon.woff')
               format('woff'),
             url('../../../fonts/icon.ttf')
               format('truetype'),
             url('../../../fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="../../../stylesheets/application.css">
    <link rel="stylesheet" href="../../../stylesheets/temporary.css">
    <link rel="stylesheet" href="../../../stylesheets/palettes.css">
    <link rel="stylesheet" href="../../../stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open%20Sans:400,700|Source+Code+Pro">
    <style>
      body, input {
        font-family: 'Open Sans', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Source Code Pro', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="../../../stylesheets/as_common.css">
    
    <link rel="stylesheet" href="../../../stylesheets/as_custom.css">
    
    <script src="../../../javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-grey palette-accent-red">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="logo">
        <a href="http://www.activestate.com/">
          <img src="../../../images/logo.png" alt="ActiveState homepage">
        </a>
      </div>
      <div class="title">
        <a href="http://docs.activestate.com/">docs.activestate.com</a>
      </div>
    </div>

    

    
    
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>

</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="../../../index.html" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../../../images/as_tcl.png">
        </div>
      
      <div class="name">
        <strong>ActiveTcl 8.6.9 Documentation </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  



<a  title="Get ActiveTcl" href="../../../get/index.html">
	
	Get ActiveTcl
</a>



  
    <ul>
      
        
        



<a  title="Release notes" href="../../../get/relnotes/index.html">
	
	Release notes
</a>



      
        
        



<a  title="Windows installation" href="../../../get/windows/index.html">
	
	Windows installation
</a>



      
        
        



<a  title="Linux/Unix Installaton" href="../../../get/linux/index.html">
	
	Linux/Unix Installaton
</a>



      
        
        



<a  title="macOS Installation" href="../../../get/macos/index.html">
	
	macOS Installation
</a>



      
        
        



<a  title="License" href="../../../get/license/index.html">
	
	License
</a>



      
    </ul>
  
</li>



<li>
  



<a  title="Get Started" href="../../../start/index.html">
	
	Get Started
</a>



  
    <ul>
      
        
        



<a  title="Package Reference" href="../../../pkg/index.html">
	
	Package Reference
</a>



      
        
        



<a  title="Tcl 8.6.9 docs" href="../../contents.html">
	
	Tcl 8.6.9 docs
</a>



      
    </ul>
  
</li>



<li>
  



<a  title="Contact Us" href="../../../contact/index.html">
	
	Contact Us
</a>



  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1> </h1>

			<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org">
<title>tsv - Tcl Threading</title>
<meta name='Author' content='ActiveState'>

</head>
<body>
<div class="doctools">


<hr>
[ <a
href="../toc.html">Thread Table Of Contents</a> | <a href=
"../index.html">Thread Index</a> ] 

<hr>
<h1 class="title">tsv(n) 2.7 "Tcl Threading"</h1>

<div id="name" class="section">
<h2><a name="name">Name</a></h2>

<p>tsv - Part of the Tcl threading extension allowing script level
manipulation of data shared between threads.</p>
</div>

<div id="toc" class="section">
<h2><a name="toc">Table Of Contents</a></h2>

<ul class="toc">
<li class="section"><a href="tsv.html#toc">Table Of Contents</a></li>

<li class="section"><a href="tsv.html#synopsis">Synopsis</a></li>

<li class="section"><a href="tsv.html#section1">Description</a></li>

<li class="section"><a href="tsv.html#section2">ELEMENT COMMANDS</a></li>

<li class="section"><a href="tsv.html#section3">LIST COMMANDS</a></li>

<li class="section"><a href="tsv.html#section4">ARRAY COMMANDS</a></li>

<li class="section"><a href="tsv.html#section5">KEYED LIST
COMMANDS</a></li>

<li class="section"><a href="tsv.html#section6">DISCUSSION</a></li>

<li class="section"><a href="tsv.html#section7">CREDITS</a></li>

<li class="section"><a href="tsv.html#see-also">See Also</a></li>

<li class="section"><a href="tsv.html#keywords">Keywords</a></li>
</ul>
</div>

<div id="synopsis" class="section">
<h2><a name="synopsis">Synopsis</a></h2>

<div class="synopsis">
<ul class="requirements">
<li>package require <b class="pkgname">Tcl 8.4</b></li>

<li>package require <b class="pkgname">Thread <span class=
"opt">?2.7?</span></b></li>
</ul>

<ul class="syntax">
<li><a href="tsv.html#1"><b class="cmd">tsv::names</b> <span class=
"opt">?pattern?</span></a></li>

<li><a href="tsv.html#2"><b class="cmd">tsv::object</b> <i class=
"arg">varname</i> <i class="arg">element</i></a></li>

<li><a href="tsv.html#3"><b class="cmd">tsv::set</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?value?</span></a></li>

<li><a href="tsv.html#4"><b class="cmd">tsv::get</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?namedvar?</span></a></li>

<li><a href="tsv.html#5"><b class="cmd">tsv::unset</b> <i class=
"arg">varname</i> <span class="opt">?element?</span></a></li>

<li><a href="tsv.html#6"><b class="cmd">tsv::exists</b> <i class=
"arg">varname</i> <i class="arg">element</i></a></li>

<li><a href="tsv.html#7"><b class="cmd">tsv::pop</b> <i class=
"arg">varname</i> <i class="arg">element</i></a></li>

<li><a href="tsv.html#8"><b class="cmd">tsv::move</b> <i class=
"arg">varname</i> <i class="arg">oldname</i> <i class=
"arg">newname</i></a></li>

<li><a href="tsv.html#9"><b class="cmd">tsv::incr</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?count?</span></a></li>

<li><a href="tsv.html#10"><b class="cmd">tsv::append</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">value</i> <span class="opt">?value ...?</span></a></li>

<li><a href="tsv.html#11"><b class="cmd">tsv::lock</b> <i class=
"arg">varname</i> <i class="arg">arg</i> <span class="opt">?arg
...?</span></a></li>

<li><a href="tsv.html#12"><b class="cmd">tsv::lappend</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">value</i> <span class="opt">?value ...?</span></a></li>

<li><a href="tsv.html#13"><b class="cmd">tsv::linsert</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">index</i> <i class="arg">value</i> <span class="opt">?value
...?</span></a></li>

<li><a href="tsv.html#14"><b class="cmd">tsv::lreplace</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">first</i> <i class="arg">last</i> <span class="opt">?value
...?</span></a></li>

<li><a href="tsv.html#15"><b class="cmd">tsv::llength</b> <i class=
"arg">varname</i> <i class="arg">element</i></a></li>

<li><a href="tsv.html#16"><b class="cmd">tsv::lindex</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?index?</span></a></li>

<li><a href="tsv.html#17"><b class="cmd">tsv::lrange</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">from</i> <i class="arg">to</i></a></li>

<li><a href="tsv.html#18"><b class="cmd">tsv::lsearch</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?options?</span> <i class="arg">pattern</i></a></li>

<li><a href="tsv.html#19"><b class="cmd">tsv::lset</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">index</i> <span class="opt">?index ...?</span> <i class=
"arg">value</i></a></li>

<li><a href="tsv.html#20"><b class="cmd">tsv::lpop</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?index?</span></a></li>

<li><a href="tsv.html#21"><b class="cmd">tsv::lpush</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?index?</span></a></li>

<li><a href="tsv.html#22"><b class="cmd">tsv::array set</b> <i class=
"arg">varname</i> <i class="arg">list</i></a></li>

<li><a href="tsv.html#23"><b class="cmd">tsv::array get</b> <i class=
"arg">varname</i> <span class="opt">?pattern?</span></a></li>

<li><a href="tsv.html#24"><b class="cmd">tsv::array names</b> <i class=
"arg">varname</i> <span class="opt">?pattern?</span></a></li>

<li><a href="tsv.html#25"><b class="cmd">tsv::array size</b> <i class=
"arg">varname</i></a></li>

<li><a href="tsv.html#26"><b class="cmd">tsv::array reset</b> <i class=
"arg">varname</i> <i class="arg">list</i></a></li>

<li><a href="tsv.html#27"><b class="cmd">tsv::array bind</b> <i class=
"arg">varname</i> <i class="arg">handle</i></a></li>

<li><a href="tsv.html#28"><b class="cmd">tsv::array unbind</b> <i class=
"arg">varname</i></a></li>

<li><a href="tsv.html#29"><b class="cmd">tsv::array isbound</b> <i class=
"arg">varname</i></a></li>

<li><a href="tsv.html#30"><b class="cmd">tsv::keyldel</b> <i class=
"arg">varname</i> <i class="arg">keylist</i> <i class=
"arg">key</i></a></li>

<li><a href="tsv.html#31"><b class="cmd">tsv::keylget</b> <i class=
"arg">varname</i> <i class="arg">keylist</i> <i class="arg">key</i>
<span class="opt">?retvar?</span></a></li>

<li><a href="tsv.html#32"><b class="cmd">tsv::keylkeys</b> <i class=
"arg">varname</i> <i class="arg">keylist</i> <span class=
"opt">?key?</span></a></li>

<li><a href="tsv.html#33"><b class="cmd">tsv::keylset</b> <i class=
"arg">varname</i> <i class="arg">keylist</i> <i class="arg">key</i>
<i class="arg">value</i> <span class="opt">?key
value..?</span></a></li>
</ul>
</div>
</div>

<div id="section1" class="section">
<h2><a name="section1">Description</a></h2>

<p>This section describes commands implementing thread shared
variables. A thread shared variable is very similar to a Tcl array
but in contrast to a Tcl array it is created in shared memory and
can be accessed from many threads at the same time. Important
feature of thread shared variable is that each access to the
variable is internaly protected by a mutex so script programmer
does not have to take care about locking the variable himself.</p>

<p>Thread shared variables are not bound to any thread explicitly.
That means that when a thread which created any of thread shared
variables exits, the variable and associated memory is not
unset/reclaimed. User has to explicitly unset the variable to
reclaim the memory consumed by the variable.</p>
</div>

<div id="section2" class="section">
<h2><a name="section2">ELEMENT COMMANDS</a></h2>

<dl class="definitions">
<dt><a name="1"><b class="cmd">tsv::names</b> <span class=
"opt">?pattern?</span></a></dt>

<dd>
<p>Returns names of shared variables matching optional <span class=
"opt">?pattern?</span> or all known variables if pattern is
ommited.</p>
</dd>

<dt><a name="2"><b class="cmd">tsv::object</b> <i class=
"arg">varname</i> <i class="arg">element</i></a></dt>

<dd>
<p>Creates object accessor command for the <i class=
"arg">element</i> in the shared variable <i class=
"arg">varname</i>. Using this command, one can apply most of the
other shared variable commands as method functions of the element
object command. The object command is automatically deleted when
the element which this command is pointing to is unset.</p>

<pre class="example">
    % tsv::set foo bar "A shared string"
    % set string [tsv::object foo bar]
    % $string append " appended"
    =&gt; A shared string appended
</pre>
</dd>

<dt><a name="3"><b class="cmd">tsv::set</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?value?</span></a></dt>

<dd>
<p>Sets the value of the <i class="arg">element</i> in the shared
variable <i class="arg">varname</i> to <i class="arg">value</i> and
returns the value to caller. The <i class="arg">value</i> may be
ommited, in which case the command will return the current value of
the element. If the element cannot be found, error is
triggered.</p>
</dd>

<dt><a name="4"><b class="cmd">tsv::get</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?namedvar?</span></a></dt>

<dd>
<p>Retrieves the value of the <i class="arg">element</i> from the
shared variable <i class="arg">varname</i>. If the optional
argument <i class="arg">namedvar</i> is given, the value is stored
in the named variable. Return value of the command depends of the
existence of the optional argument <i class="arg">namedvar</i>. If
the argument is ommited and the requested element cannot be found
in the shared array, the command triggers error. If, however, the
optional argument is given on the command line, the command returns
true (1) if the element is found or false (0) if the element is not
found.</p>
</dd>

<dt><a name="5"><b class="cmd">tsv::unset</b> <i class=
"arg">varname</i> <span class="opt">?element?</span></a></dt>

<dd>
<p>Unsets the <i class="arg">element</i> from the shared variable
<i class="arg">varname</i>. If the optional element is not given,
it deletes the variable.</p>
</dd>

<dt><a name="6"><b class="cmd">tsv::exists</b> <i class=
"arg">varname</i> <i class="arg">element</i></a></dt>

<dd>
<p>Checks wether the <i class="arg">element</i> exists in the
shared variable <i class="arg">varname</i> and returns true (1) if
it does or false (0) if it doesn't.</p>
</dd>

<dt><a name="7"><b class="cmd">tsv::pop</b> <i class=
"arg">varname</i> <i class="arg">element</i></a></dt>

<dd>
<p>Returns value of the <i class="arg">element</i> in the shared
variable <i class="arg">varname</i> and unsets the element, all in
one atomic operation.</p>
</dd>

<dt><a name="8"><b class="cmd">tsv::move</b> <i class=
"arg">varname</i> <i class="arg">oldname</i> <i class=
"arg">newname</i></a></dt>

<dd>
<p>Renames the element <i class="arg">oldname</i> to the <i class=
"arg">newname</i> in the shared variable <i class=
"arg">varname</i>. This effectively performs an get/unset/set
sequence of operations but all in one atomic step.</p>
</dd>

<dt><a name="9"><b class="cmd">tsv::incr</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?count?</span></a></dt>

<dd>
<p>Similar to standard Tcl <b class="cmd">incr</b> command but
increments the value of the <i class="arg">element</i> in shared
variaboe <i class="arg">varname</i> instead of the Tcl
variable.</p>
</dd>

<dt><a name="10"><b class="cmd">tsv::append</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">value</i> <span class="opt">?value ...?</span></a></dt>

<dd>
<p>Similar to standard Tcl <b class="cmd">append</b> command but
appends one or more values to the <i class="arg">element</i> in
shared variable <i class="arg">varname</i> instead of the Tcl
variable.</p>
</dd>

<dt><a name="11"><b class="cmd">tsv::lock</b> <i class=
"arg">varname</i> <i class="arg">arg</i> <span class="opt">?arg
...?</span></a></dt>

<dd>
<p>This command concatenates passed arguments and evaluates the
resulting script under the internal mutex protection. During the
script evaluation, the entire shared variable is locked. For shared
variable commands within the script, internal locking is disabled
so no deadlock can occur. It is also allowed to unset the shared
variable from within the script. The shared variable is
automatically created if it did not exists at the time of the first
lock operation.</p>

<pre class="example">
    % tsv::lock foo {
        tsv::lappend foo bar 1
        tsv::lappend foo bar 2
        puts stderr [tsv::set foo bar]
        tsv::unset foo
    }
</pre>
</dd>
</dl>
</div>

<div id="section3" class="section">
<h2><a name="section3">LIST COMMANDS</a></h2>

<p>Those command are similar to the equivalently named Tcl command.
The difference is that they operate on elements of shared
arrays.</p>

<dl class="definitions">
<dt><a name="12"><b class="cmd">tsv::lappend</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">value</i> <span class="opt">?value ...?</span></a></dt>

<dd>
<p>Similar to standard Tcl <b class="cmd">lappend</b> command but
appends one or more values to the <i class="arg">element</i> in
shared variable <i class="arg">varname</i> instead of the Tcl
variable.</p>
</dd>

<dt><a name="13"><b class="cmd">tsv::linsert</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">index</i> <i class="arg">value</i> <span class="opt">?value
...?</span></a></dt>

<dd>
<p>Similar to standard Tcl <b class="cmd">linsert</b> command but
inserts one or more values at the <i class="arg">index</i> list
position in the <i class="arg">element</i> in the shared variable
<i class="arg">varname</i> instead of the Tcl variable.</p>
</dd>

<dt><a name="14"><b class="cmd">tsv::lreplace</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">first</i> <i class="arg">last</i> <span class="opt">?value
...?</span></a></dt>

<dd>
<p>Similar to standard Tcl <b class="cmd">lreplace</b> command but
replaces one or more values between the <i class="arg">first</i>
and <i class="arg">last</i> position in the <i class=
"arg">element</i> of the shared variable <i class="arg">varname</i>
instead of the Tcl variable.</p>
</dd>

<dt><a name="15"><b class="cmd">tsv::llength</b> <i class=
"arg">varname</i> <i class="arg">element</i></a></dt>

<dd>
<p>Similar to standard Tcl <b class="cmd">llength</b> command but
returns length of the <i class="arg">element</i> in the shared
variable <i class="arg">varname</i> instead of the Tcl
variable.</p>
</dd>

<dt><a name="16"><b class="cmd">tsv::lindex</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?index?</span></a></dt>

<dd>
<p>Similar to standard Tcl <b class="cmd">lindex</b> command but
returns the value at the <i class="arg">index</i> list position of
the <i class="arg">element</i> from the shared variable <i class=
"arg">varname</i> instead of the Tcl variable.</p>
</dd>

<dt><a name="17"><b class="cmd">tsv::lrange</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">from</i> <i class="arg">to</i></a></dt>

<dd>
<p>Similar to standard Tcl <b class="cmd">lrange</b> command but
returns values between <i class="arg">from</i> and <i class=
"arg">to</i> list positions from the <i class="arg">element</i> in
the shared variable <i class="arg">varname</i> instead of the Tcl
variable.</p>
</dd>

<dt><a name="18"><b class="cmd">tsv::lsearch</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?options?</span> <i class="arg">pattern</i></a></dt>

<dd>
<p>Similar to standard Tcl <b class="cmd">lsearch</b> command but
searches the <i class="arg">element</i> in the shared variable <i
class="arg">varname</i> instead of the Tcl variable.</p>
</dd>

<dt><a name="19"><b class="cmd">tsv::lset</b> <i class=
"arg">varname</i> <i class="arg">element</i> <i class=
"arg">index</i> <span class="opt">?index ...?</span> <i class=
"arg">value</i></a></dt>

<dd>
<p>Similar to standard Tcl <b class="cmd">lset</b> command but sets
the <i class="arg">element</i> in the shared variable <i class=
"arg">varname</i> instead of the Tcl variable.</p>
</dd>

<dt><a name="20"><b class="cmd">tsv::lpop</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?index?</span></a></dt>

<dd>
<p>Similar to the standard Tcl <b class="cmd">lindex</b> command
but in addition to returning, it also splices the value out of the
<i class="arg">element</i> from the shared variable <i class=
"arg">varname</i> in one atomic operation. In contrast to the Tcl
<b class="cmd">lindex</b> command, this command returns no value to
the caller.</p>
</dd>

<dt><a name="21"><b class="cmd">tsv::lpush</b> <i class=
"arg">varname</i> <i class="arg">element</i> <span class=
"opt">?index?</span></a></dt>

<dd>
<p>This command performes the opposite of the <b class=
"cmd">tsv::lpop</b> command. As its counterpart, it returns no
value to the caller.</p>
</dd>
</dl>
</div>

<div id="section4" class="section">
<h2><a name="section4">ARRAY COMMANDS</a></h2>

<p>This command supports most of the options of the standard Tcl <b
class="cmd">array</b> command. In addition to those, it allows
binding a shared variable to some persisten storage databases.
Currently the only persistent option supported is the famous GNU
Gdbm database. This option has to be selected during the package
compilation time. The implementation provides hooks for defining
other persistency layers, if needed.</p>

<dl class="definitions">
<dt><a name="22"><b class="cmd">tsv::array set</b> <i class=
"arg">varname</i> <i class="arg">list</i></a></dt>

<dd>
<p>Does the same as standard Tcl <b class="cmd">array set</b>.</p>
</dd>

<dt><a name="23"><b class="cmd">tsv::array get</b> <i class=
"arg">varname</i> <span class="opt">?pattern?</span></a></dt>

<dd>
<p>Does the same as standard Tcl <b class="cmd">array get</b>.</p>
</dd>

<dt><a name="24"><b class="cmd">tsv::array names</b> <i class=
"arg">varname</i> <span class="opt">?pattern?</span></a></dt>

<dd>
<p>Does the same as standard Tcl <b class="cmd">array
names</b>.</p>
</dd>

<dt><a name="25"><b class="cmd">tsv::array size</b> <i class=
"arg">varname</i></a></dt>

<dd>
<p>Does the same as standard Tcl <b class="cmd">array size</b>.</p>
</dd>

<dt><a name="26"><b class="cmd">tsv::array reset</b> <i class=
"arg">varname</i> <i class="arg">list</i></a></dt>

<dd>
<p>Does the same as standard Tcl <b class="cmd">array set</b> but
it clears the <i class="arg">varname</i> and sets new values from
the list atomically.</p>
</dd>

<dt><a name="27"><b class="cmd">tsv::array bind</b> <i class=
"arg">varname</i> <i class="arg">handle</i></a></dt>

<dd>
<p>Binds the <i class="arg">varname</i> to the persistent storage
<i class="arg">handle</i>. The format of the <i class=
"arg">handle</i> is &lt;handler&gt;:&lt;address&gt;. For the
built-in GNU Gdbm persistence layer, the format of the handle is
"gdbm:&lt;path&gt;" where &lt;path&gt; is the path to the Gdbm
database file.</p>
</dd>

<dt><a name="28"><b class="cmd">tsv::array unbind</b> <i class=
"arg">varname</i></a></dt>

<dd>
<p>Unbinds the shared <i class="arg">array</i> from its bound
persistent storage.</p>
</dd>

<dt><a name="29"><b class="cmd">tsv::array isbound</b> <i class=
"arg">varname</i></a></dt>

<dd>
<p>Returns true (1) if the shared <i class="arg">varname</i> is
bound to some persistent storage or zero (0) if not.</p>
</dd>
</dl>
</div>

<div id="section5" class="section">
<h2><a name="section5">KEYED LIST COMMANDS</a></h2>

<p>Keyed list commands are borrowed from the TclX package. Keyed
lists provide a structured data type built upon standard Tcl lists.
This is a functionality similar to structs in the C programming
language.</p>

<p>A keyed list is a list in which each element contains a key and
value pair. These element pairs are stored as lists themselves,
where the key is the first element of the list, and the value is
the second. The key-value pairs are referred to as fields. This is
an example of a keyed list:</p>

<pre class="example">
    {{NAME  {Frank  Zappa}} {JOB {musician and composer}}}
</pre>

<p>Fields may contain subfields; `.' is the separator character.
Subfields are actually fields where the value is another keyed
list. Thus the following list has the top level fields ID and NAME,
and subfields NAME.FIRST and NAME.LAST:</p>

<pre class="example">
    {ID 106} {NAME {{FIRST Frank} {LAST Zappa}}}
</pre>

<p>There is no limit to the recursive depth of subfields, allowing
one to build complex data structures. Keyed lists are constructed
and accessed via a number of commands. All keyed list management
commands take the name of the variable containing the keyed list as
an argument (i.e. passed by reference), rather than passing the
list directly.</p>

<dl class="definitions">
<dt><a name="30"><b class="cmd">tsv::keyldel</b> <i class=
"arg">varname</i> <i class="arg">keylist</i> <i class=
"arg">key</i></a></dt>

<dd>
<p>Delete the field specified by <i class="arg">key</i> from the
keyed list <i class="arg">keylist</i> in the shared variable <i
class="arg">varname</i>. This removes both the key and the value
from the keyed list.</p>
</dd>

<dt><a name="31"><b class="cmd">tsv::keylget</b> <i class=
"arg">varname</i> <i class="arg">keylist</i> <i class="arg">key</i>
<span class="opt">?retvar?</span></a></dt>

<dd>
<p>Return the value associated with <i class="arg">key</i> from the
keyed list <i class="arg">keylist</i> in the shared variable <i
class="arg">varname</i>. If the optional <i class="arg">retvar</i>
is not specified, then the value will be returned as the result of
the command. In this case, if key is not found in the list, an
error will result.</p>

<p>If <i class="arg">retvar</i> is specified and <i class=
"arg">key</i> is in the list, then the value is returned in the
variable <i class="arg">retvar</i> and the command returns 1 if the
key was present within the list. If <i class="arg">key</i> isn't in
the list, the command will return 0, and <i class="arg">retvar</i>
will be left unchanged. If {} is specified for <i class=
"arg">retvar</i>, the value is not returned, allowing the Tcl
programmer to determine if a <i class="arg">key</i> is present in a
keyed list without setting a variable as a side-effect.</p>
</dd>

<dt><a name="32"><b class="cmd">tsv::keylkeys</b> <i class=
"arg">varname</i> <i class="arg">keylist</i> <span class=
"opt">?key?</span></a></dt>

<dd>
<p>Return the a list of the keys in the keyed list <i class=
"arg">keylist</i> in the shared variable <i class=
"arg">varname</i>. If <i class="arg">key</i> is specified, then it
is the name of a key field who's subfield keys are to be
retrieved.</p>
</dd>

<dt><a name="33"><b class="cmd">tsv::keylset</b> <i class=
"arg">varname</i> <i class="arg">keylist</i> <i class="arg">key</i>
<i class="arg">value</i> <span class="opt">?key
value..?</span></a></dt>

<dd>
<p>Set the value associated with <i class="arg">key</i>, in the
keyed list <i class="arg">keylist</i> to <i class="arg">value</i>.
If the <i class="arg">keylist</i> does not exists, it is created.
If <i class="arg">key</i> is not currently in the list, it will be
added. If it already exists, <i class="arg">value</i> replaces the
existing value. Multiple keywords and values may be specified, if
desired.</p>
</dd>
</dl>
</div>

<div id="section6" class="section">
<h2><a name="section6">DISCUSSION</a></h2>

<p>The current implementation of thread shared variables allows for
easy and convenient access to data shared between different
threads. Internally, the data is stored in Tcl objects and all
package commands operate on internal data representation, thus
minimizing shimmering and improving performance. Special care has
been taken to assure that all object data is properly locked and
deep-copied when moving objects between threads.</p>

<p>Due to the internal design of the Tcl core, there is no
provision of full integration of shared variables within the Tcl
syntax, unfortunately. All access to shared data must be performed
with the supplied package commands. Also, variable traces are not
supported. But even so, benefits of easy, simple and safe shared
data manipulation outweights imposed limitations.</p>
</div>

<div id="section7" class="section">
<h2><a name="section7">CREDITS</a></h2>

<p>Thread shared variables are inspired by the nsv interface found
in AOLserver, a highly scalable Web server from America Online.</p>
</div>

<div id="see-also" class="section">
<h2><a name="see-also">See Also</a></h2>

<p><a href="thread.html">thread</a>, <a href=
"tpool.html">tpool</a>, <a href="ttrace.html">ttrace</a></p>
</div>

<div id="keywords" class="section">
<h2><a name="keywords">Keywords</a></h2>

<p><a href="../index.html#key3">locking</a>, <a href=
"../index.html#key6">synchronization</a>, <a href=
"../index.html#key8">thread shared data</a>, <a href=
"../index.html#key10">threads</a></p>
</div>

<h4>Copyright &copy; 2015 <a href="http://www.activestate.com">for
compilation: ActiveState</a></h4>
</div>
</body>
</html>



			<aside class="copyright" role="note">
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				<div class="as_footer">
  
  <div class="prod_links">
    <strong>
      <a href="http://platform.activestate.com/" target="_blank">ActiveState Platform</a>&nbsp;&nbsp;
      <a href="http://www.activestate.com/downloads" target="_blank">Downloads</a>&nbsp;&nbsp;
      <a href="http://community.activestate.com/" target="_blank">Community</a>&nbsp;&nbsp;
      <a href="http://github.com/activestate/code" target="_blank">Code Recipes</a>&nbsp;&nbsp;
    </strong>
  </div>
  <div class="as_copyright"> 
    &copy; 2019 ActiveState Software Inc. All rights reserved. <strong><a href="../../../trademarks/index.html">Trademarks</a>. <a href="http://www.activestate.com/privacy-policy">Privacy Policy</a>.</strong>
  </div>
</div>

			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="../../../javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "¶";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-20072-24', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="../../../javascripts/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

